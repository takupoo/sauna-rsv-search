# iOSショートカット作成ガイド

## 概要
サウナ整作所の今日の空き枠をワンタップで確認するショートカット

## プログラムID一覧
| コース | ID |
|--------|-----|
| 45分 | 190 |
| 70分 | 191 |
| 90分 | 193 |
| 45分（朝ウナ）| 194 |

---

## 作成手順

### 1. ショートカットアプリを開く
iPhoneで「ショートカット」アプリを開き、右上の「+」をタップ

### 2. 変数を設定

#### アクション: テキスト
```
🧖 サウナ整作所 空き枠

```
→ 変数名「結果」に設定（長押し→「変数に設定」→「結果」と入力）

#### アクション: 日付
「現在の日付」を追加
→ 日付をフォーマット: カスタム `yyyy-MM-dd`
→ 変数名「今日」に設定

---

### 3. 各プログラムをチェック（90分の例）

#### アクション: URL
```
https://sauna-seisakusyo.hacomono.jp/api/reservation/reservations/choice/reserve-schedule?studio_room_id=51&program_id=193&query=%7B%22page%22:1,%22is_all%22:false,%22is_flat%22:false,%22is_fast%22:false,%22instructor_ids%22:null,%22date_from%22:null,%22date_to%22:null%7D
```

#### アクション: URLの内容を取得
（デフォルト設定のまま）

#### アクション: 辞書から値を取得
キー: `data.reserve_schedule.dates`

#### アクション: 各項目を繰り返す

##### 繰り返し内: 辞書から値を取得
キー: `date`

##### 繰り返し内: if文
「辞書の値」が「今日」と「等しい」

###### if内: 辞書から値を取得
入力: 繰り返し項目
キー: `times`

###### if内: 各項目を繰り返す（ネスト）

####### ネスト繰り返し内: 辞書から値を取得
キー: `is_reservable`

####### ネスト繰り返し内: if文
「辞書の値」が「1」と「等しい」（または「true」）

######## if内: 辞書から値を取得
入力: 繰り返し項目
キー: `start_at`

######## if内: 日付を調整
入力を日付として取得

######## if内: 日付をフォーマット
フォーマット: `HH:mm`

######## if内: テキスト
```
【90分】[フォーマット済み日付]
```

######## if内: テキストを変数に追加
変数「結果」に追加

---

### 4. 他のプログラムも同様に追加
- 45分: program_id=190
- 70分: program_id=191
- 45分朝ウナ: program_id=194

上記の手順3を各プログラムIDで繰り返す

---

### 5. 結果を表示

#### アクション: 結果を表示
入力: 変数「結果」

---

## シンプル版（1プログラムのみ）

複雑すぎる場合は、90分のみチェックするシンプル版：

### ショートカットの内容

1. **URL**
   ```
   https://sauna-seisakusyo.hacomono.jp/api/reservation/reservations/choice/reserve-schedule?studio_room_id=51&program_id=193&query=%7B%22page%22:1,%22is_all%22:false,%22is_flat%22:false,%22is_fast%22:false,%22instructor_ids%22:null,%22date_from%22:null,%22date_to%22:null%7D
   ```

2. **URLの内容を取得**

3. **クイックルック**
   → JSONの生データを表示（開発確認用）

---

## トラブルシューティング

### 「辞書から値を取得」でエラーが出る
- キーのスペルを確認
- ドット記法（data.reserve_schedule.dates）が正しいか確認

### 空き枠があるはずなのに表示されない
- `is_reservable` の判定が正しいか確認
- true/false の比較が正しいか確認（数値の1/0として比較してみる）

### APIエラーが出る
- ネットワーク接続を確認
- URLが正しくコピーされているか確認
